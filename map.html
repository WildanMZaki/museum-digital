<!doctype html>
<html lang="id">
  <head>
    <meta charset="utf-8">
    <title>Peta â€” Museum Digital</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap & Leaflet -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet">
    <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      rel="stylesheet" />
    <link href="assets/css/styles.css" rel="stylesheet">
    <style>
    body {
      background: #f6edd9;
    }
    #map{
      height:70vh;
      border-radius:16px;
      box-shadow: 0 4px 24px #e7c28299;
      background: #f6edd9;
    }
    .card, .sidebar-map {
      background: #fbf8f1;
      border-radius: 10px;
      box-shadow: 0 2px 12px #e5dcc1;
    }
    .minimap-wrapper .island-btn {
      margin: 0 9px 9px 0;
      background: #ffeec2;
      border: 1px solid #d1b375;
      color: #a17421;
      font-weight: bold;
      border-radius: 8px;
      padding: 8px 16px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .minimap-wrapper .island-btn:active, .minimap-wrapper .island-btn.active {
      background: #eec176;
      color: #633d17;
    }
    .topic-select {
      background: #faf1e3;
    }
    .focused-area {
      border: 2px solid #a17421;
      box-shadow: 0 2px 24px #d6b257;
    }
    .island-btn svg {
      vertical-align: middle;
      margin-right: 4px;
      margin-bottom: 2px;
    }
    .topik-info {
      background: #faecd8;
      padding: 1em;
      border-radius: 9px;
      font-size: 15px;
      margin-bottom: 14px;
      color: #785924;
    }
    .leaflet-control-layers {
      background: #faecd8 !important;
      border-radius: 7px;
      padding-top: 8px !important;
      font-size: 14px;
    }
  </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary shadow-sm">
      <div class="container">
        <a class="navbar-brand" href="#">Museum Digital</a>
        <div class="ms-auto">
          <a class="btn btn-outline-primary btn-sm me-2"
            href="enroll.html">Enroll</a>
          <div class="btn-group ms-2">
            <a class="btn btn-primary btn-sm" href="timeline.html">Timeline</a>
          </div>
        </div>
      </div>
    </nav>
    <main class="container py-3">
      <div class="row g-3">
        <div class="col-lg-8">
          <div id="map" class="shadow-sm"></div>
          <div class="mt-2 small text-muted">Gunakan kontrol layer di pojok
            kanan atas untuk on/off kategori.</div>
        </div>
        <div class="col-lg-4">
          <div class="card sidebar-map shadow-sm mb-3">
            <div class="card-body minimap-wrapper">
              <h2 class="h5 mb-2">Pilih Pulau</h2>
              <div id="minimap" class="mb-2">
                <!-- SVG clickable / icon based pulau besar -->
                <button data-island="sumatra" class="island-btn">
                  <svg width="30" height="18"><ellipse cx="15" cy="9" rx="14"
                      ry="7" fill="#dbbe91" /></svg> Sumatra
                </button>
                <button data-island="jawa" class="island-btn">
                  <svg width="32" height="16"><rect x="3" y="5" width="25"
                      height="7" rx="6" fill="#dbbe91" /></svg> Jawa
                </button>
                <button data-island="kalimantan" class="island-btn">
                  <svg width="26" height="20"><ellipse cx="13" cy="10" rx="11"
                      ry="8" fill="#dbbe91" /></svg> Kalimantan
                </button>
                <button data-island="sulawesi" class="island-btn">
                  <svg width="22" height="20"><ellipse cx="11" cy="10" rx="10"
                      ry="6" fill="#dbbe91" /><rect x="5" y="3" width="7"
                      height="7" rx="3" fill="#d1b375" /></svg> Sulawesi
                </button>
                <button data-island="papua" class="island-btn">
                  <svg width="27" height="15"><ellipse cx="13" cy="8" rx="10"
                      ry="6" fill="#dbbe91" /></svg> Papua
                </button>
              </div>
              <small>Pilih pulau utama untuk fokus area peta.</small>
            </div>
          </div>
          <div class="card shadow-sm topic-select mb-3">
            <div class="card-body">
              <h2 class="h5 mb-2">Topik Museum</h2>
              <select id="topicSelector" class="form-select mb-2">
                <option value="figures">Wali Songo</option>
                <option value="kingdoms">Kerajaan Islam</option>
                <option value="artifacts">Artefak Islam</option>
              </select>
              <div id="topikDesc" class="topik-info">
                Sebaran pusat dakwah dan jejak Wali Songo di pesisir Jawa.
              </div>
              <small>Pilih topik untuk menampilkan informasi terkait saja di
                map.</small>
            </div>
          </div>
        </div>
      </div>
    </main>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="assets/js/data.js"></script>
    <script src="assets/js/map.js"></script>
    <script>
// =========== Sidebar Minimap Navigation ============
document.querySelectorAll('.island-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    const ISLAND_BOUNDS = {
      sumatra:   [[-6.5,  95.0], [ 6.5, 106.0]],
      jawa:      [[-8.8, 105.0], [-5.0, 114.8]],
      kalimantan:[[ -4.8, 108.0], [ 4.8, 119.5]],
      sulawesi:  [[ -6.5, 119.0], [ 3.5, 125.5]],
      papua:     [[-10.0, 130.0], [ 1.0, 141.5]]
    };
    const key = this.getAttribute('data-island');
    const b = ISLAND_BOUNDS[key];
    if (b && window.mapRef) {
      const bounds = L.latLngBounds(b[0], b[1]);
      window.mapRef.flyToBounds(bounds, { padding: [24,24], duration: 1.4 });
    }
    document.querySelectorAll('.island-btn').forEach(b=>b.classList.remove('active'));
    this.classList.add('active');
  });
});
// Topik selector: show only selected layer
const topikDescList = {
  figures: "Sebaran pusat dakwah dan jejak Wali Songo di pesisir Jawa.",
  kingdoms: "Kerajaan, Kesultanan, dan penyebaran Islam di Nusantara.",
  artifacts: "Artefak, peninggalan, dan benda bersejarah era Islam."
};
document.getElementById('topicSelector').addEventListener('change', function() {
  const val = this.value;
  document.getElementById('topikDesc').innerText = topikDescList[val] || "";
  if(window.__layers) {
    Object.entries(window.__layers).forEach(([k,layer])=>{
      if(k == ("layer"+val.charAt(0).toUpperCase()+val.slice(1))) {
        window.mapRef.addLayer(layer);
      } else {
        window.mapRef.removeLayer(layer);
      }
    });
  }
});
// Set default topik based on selector
window.addEventListener("DOMContentLoaded",()=> {
  document.getElementById('topicSelector').dispatchEvent(new Event("change"));
});
</script>
  </body>
</html>