<!doctype html>
<html lang="id">
  <head>
    <meta charset="utf-8">
    <title>Peta ‚Äî Museum Digital</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&family=Playfair+Display:wght@600&display=swap"
      rel="stylesheet">

    <!-- Bootstrap & Leaflet -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet">
    <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      rel="stylesheet" />
    <link href="assets/css/styles.css" rel="stylesheet">

    <style>
    /* ============= WARNA & FONTS ============= */
    body {
      background: #f6edd9;
      font-family: 'Poppins', sans-serif;
      color: #5c3b1e;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Playfair Display', serif;
      color: #5c3b1e;
    }

    /* ============= MAP AREA ============= */
    #map {
      height: 70vh;
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(139, 97, 47, 0.2);
      background: #f7f1e2;
    }

    /* ============= CARD & SIDEBAR ============= */
    .card, .sidebar-map {
      background: #fbf8f1;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(175, 136, 80, 0.15);
      border: 1px solid #e7d3b0;
    }

    /* ============= BUTTON PULAU ============= */
    .minimap-wrapper .island-btn {
      margin: 0 9px 9px 0;
      background: #ffedc2;
      border: 1px solid #c6a567;
      color: #79511e;
      font-weight: 600;
      border-radius: 8px;
      padding: 8px 16px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .minimap-wrapper .island-btn:hover {
      background: #f1d7a5;
      transform: translateY(-2px);
    }

    .minimap-wrapper .island-btn:active, 
    .minimap-wrapper .island-btn.active {
      background: #c9a46a;
      color: #fff7ec;
      box-shadow: 0 3px 8px rgba(129, 82, 26, 0.3);
    }

    .island-btn svg {
      vertical-align: middle;
      margin-right: 5px;
      margin-bottom: 2px;
    }

    /* ============= CUSTOM DROPDOWN STYLE ============= */
    .custom-dropdown {
      appearance: none;
      background-color: #fffaf2;
      color: #4b3211;
      border: 2px solid #c9a77a;
      border-radius: 12px;
      padding: 12px 16px;
      font-weight: 500;
      font-size: 15px;
      width: 100%;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 3px 10px rgba(157, 115, 53, 0.1);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%237b5e2e' class='bi bi-chevron-down' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 1rem center;
      background-size: 1em;
    }

    .custom-dropdown:hover {
      border-color: #b48746;
      box-shadow: 0 4px 12px rgba(155, 98, 35, 0.15);
    }

    .custom-dropdown:focus {
      outline: none;
      border-color: #8a612e;
      box-shadow: 0 0 0 4px rgba(204, 166, 103, 0.35);
    }

    .custom-dropdown option {
      background-color: #fffaf2;
      color: #4b3211;
      font-weight: 500;
      padding: 8px 10px;
    }

    .topic-select h2 {
      font-family: 'Playfair Display', serif;
      color: #6b451b;
      font-weight: 600;
      border-bottom: 2px solid #e3c9a4;
      padding-bottom: 6px;
      display: inline-block;
    }

    .topik-info {
      background: #f9efde;
      border-radius: 10px;
      padding: 1em;
      text-align: center;
      color: #604221;
      box-shadow: inset 0 2px 6px rgba(193, 145, 80, 0.15);
      font-size: 15px;
    }

    /* ============= LEAFLET CONTROL ============= */
    .leaflet-control-layers {
      background: #f9efde !important;
      border-radius: 7px;
      padding-top: 8px !important;
      font-size: 14px;
      border: 1px solid #e7d3b0;
    }
    </style>
  </head>

  <body>
    <!-- ============= NAVBAR ============= -->
    <nav class="navbar navbar-expand-lg shadow-sm"
      style="background:rgba(233, 213, 192, 0.9); border-bottom:1px solid #e7d3b0;">
      <div class="container">
        <a class="navbar-brand fw-bold"
          style="font-family:'Playfair Display',serif; color:#79511e;"
          href="#">üïå Museum Digital</a>
        <div class="ms-auto">
          <a class="btn btn-primary btn-sm"
            style="background:#c9a46a; border:none;"
            href="timeline.html">Timeline</a>
        </div>
      </div>
    </nav>

    <!-- ============= MAIN CONTENT ============= -->
    <main class="container py-3">
      <div class="row g-3">
        <!-- MAP -->
        <div class="col-lg-8">
          <div id="map" class="shadow-sm"></div>
          <div class="mt-2 small text-muted">Gunakan kontrol layer di pojok
            kanan atas untuk on/off kategori.</div>
        </div>

        <!-- SIDEBAR -->
        <div class="col-lg-4">
          <!-- PULAU PILIHAN -->
          <div class="card sidebar-map shadow-sm mb-3">
            <div class="card-body minimap-wrapper"
              style="background: rgba(254, 231, 206, 0.9)">
              <h2 class="h5 mb-2">Pilih Pulau</h2>
              <div id="minimap" class="mb-2">
                <button data-island="sumatra" class="island-btn"><svg width="30"
                    height="18"><ellipse cx="15" cy="9" rx="14" ry="7"
                      fill="#dbbe91" /></svg> Sumatra</button>
                <button data-island="jawa" class="island-btn"><svg width="32"
                    height="16"><rect x="3" y="5" width="25" height="7" rx="6"
                      fill="#dbbe91" /></svg> Jawa</button>
                <button data-island="kalimantan" class="island-btn"><svg
                    width="26" height="20"><ellipse cx="13" cy="10" rx="11"
                      ry="8" fill="#dbbe91" /></svg> Kalimantan</button>
                <button data-island="sulawesi" class="island-btn"><svg
                    width="22" height="20"><ellipse cx="11" cy="10" rx="10"
                      ry="6" fill="#dbbe91" /><rect x="5" y="3" width="7"
                      height="7" rx="3" fill="#d1b375" /></svg>
                  Sulawesi</button>
                <button data-island="papua" class="island-btn"><svg width="27"
                    height="15"><ellipse cx="13" cy="8" rx="10" ry="6"
                      fill="#dbbe91" /></svg> Papua</button>
              </div>
              <small>Pilih pulau utama untuk fokus area peta.</small>
            </div>
          </div>

          <!-- DROPDOWN TOPIK -->
          <div class="card shadow-sm topic-select mb-3">
            <div class="card-body" style="background: rgba(254, 231, 206, 0.9)">
              <h2 class="h5 mb-3 text-center">Topik Museum</h2>

              <select id="topicSelector"
                class="form-select custom-dropdown mb-3">
                <option value="figures">üïå Wali Songo</option>
                <option value="kingdoms">üè∞ Kerajaan Islam</option>
                <option value="artifacts">‚ö±Ô∏è Artefak Islam</option>
              </select>

              <div id="topikDesc" class="topik-info">
                Sebaran pusat dakwah dan jejak Wali Songo di pesisir Jawa.
              </div>

              <small class="d-block text-center mt-2">Pilih topik untuk
                menampilkan informasi di peta.</small>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- ============= SCRIPTS ============= -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="assets/js/data.js"></script>
    <script src="assets/js/map.js"></script>

    <script>
    // === PENGENDALI PULAU ===
    document.querySelectorAll('.island-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const ISLAND_BOUNDS = {
          sumatra: [[-6.5, 95.0], [6.5, 106.0]],
          jawa: [[-8.8, 105.0], [-5.0, 114.8]],
          kalimantan: [[-4.8, 108.0], [4.8, 119.5]],
          sulawesi: [[-6.5, 119.0], [3.5, 125.5]],
          papua: [[-10.0, 130.0], [1.0, 141.5]]
        };
        const key = this.getAttribute('data-island');
        const b = ISLAND_BOUNDS[key];
        if (b && window.mapRef) {
          const bounds = L.latLngBounds(b[0], b[1]);
          window.mapRef.flyToBounds(bounds, { padding: [24,24], duration: 1.4 });
        }
        document.querySelectorAll('.island-btn').forEach(b=>b.classList.remove('active'));
        this.classList.add('active');
      });
    });

    // === DROPDOWN TOPIK ===
    const topikDescList = {
      figures: "Sebaran pusat dakwah dan jejak Wali Songo di pesisir Jawa.",
      kingdoms: "Kerajaan, Kesultanan, dan penyebaran Islam di Nusantara.",
      artifacts: "Artefak, peninggalan, dan benda bersejarah era Islam."
    };

    document.getElementById('topicSelector').addEventListener('change', function() {
      const val = this.value;
      document.getElementById('topikDesc').innerText = topikDescList[val] || "";
      if(window.__layers) {
        Object.entries(window.__layers).forEach(([k,layer])=>{
          if(k == ("layer"+val.charAt(0).toUpperCase()+val.slice(1))) {
            window.mapRef.addLayer(layer);
          } else {
            window.mapRef.removeLayer(layer);
          }
        });
      }
    });

    // Default trigger
    window.addEventListener("DOMContentLoaded",()=> {
      document.getElementById('topicSelector').dispatchEvent(new Event("change"));
    });
    </script>
  </body>
</html>
